<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>uuid45 WASM Demo</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 1rem; }
    input[type=text] { width: 480px; max-width: 100%; }
    code { background: #f4f4f4; padding: 2px 4px; }
    .row { margin: 0.5rem 0; }
  </style>
</head>
<body>
  <h1>uuid45 WASM Demo</h1>
  <p>Generate UUID v4, encode to Base45 compact string, and decode back.</p>

  <div class="row">
    <button id="btn-gen">Generate v4</button>
    <span id="uuid"></span>
  </div>

  <div class="row">
    <label>UUID input: <input type="text" id="uuid-in" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"></label>
    <button id="btn-enc">Encode</button>
  </div>
  <div class="row">
    <label>Base45: <code id="b45"></code></label>
  </div>

  <div class="row">
    <label>Base45 input: <input type="text" id="b45-in" placeholder="Base45 string"></label>
    <button id="btn-dec">Decode</button>
  </div>
  <div class="row">
    <label>Decoded UUID: <code id="uuid-out"></code></label>
  </div>

  <script type="module">
    import init, { wasm_gen_v4, wasm_encode_uuid_str, wasm_decode_to_uuid_str } from './pkg/uuid45.js';

    async function main() {
      await init();
      const uuidSpan = document.getElementById('uuid');
      const b45Span = document.getElementById('b45');
      const uuidOut = document.getElementById('uuid-out');
      const uuidIn = document.getElementById('uuid-in');
      const b45In = document.getElementById('b45-in');

      document.getElementById('btn-gen').addEventListener('click', () => {
        const u = wasm_gen_v4();
        uuidSpan.textContent = u;
        (uuidIn).value = u;
      });

      document.getElementById('btn-enc').addEventListener('click', async () => {
        try {
          const s = await wasm_encode_uuid_str(uuidIn.value.trim());
          b45Span.textContent = s;
        } catch (e) {
          alert('Encode error: ' + e);
        }
      });

      document.getElementById('btn-dec').addEventListener('click', async () => {
        try {
          const s = await wasm_decode_to_uuid_str(b45In.value.trim());
          uuidOut.textContent = s;
        } catch (e) {
          alert('Decode error: ' + e);
        }
      });
    }

    main();
  </script>
</body>
</html>
